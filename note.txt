For export task report controller

üìù 10-Line Explanation:
Fetches all tasks from the database and populates the assignedTo field with the user's name and email.

Creates a new Excel workbook and worksheet using excelJS.

Defines the structure of the Excel columns, including headers like title, priority, due date, etc.

Loops through each task and formats the data, including assigning user details.

Formats the due date to a readable format (YYYY-MM-DD).

Sets the correct response headers to trigger a file download in the browser.

Writes the Excel workbook directly to the HTTP response stream.

Ensures the response ends after sending the file.

Catches any errors that occur during the export process.

Sends a 500 error message with error details if something goes wrong.



for export user task controller function

üìù 10-Line Explanation:
Fetches all users from the database and all tasks with their assigned user populated.

Initializes a data map (userTaskMap) for aggregating task stats per user.

Iterates through tasks and increments task counts for the assigned user by status.

Uses excelJS to create a workbook and worksheet for reporting.

Defines headers like user name, email, and counts of each task status.

Adds each user's aggregated task data as a new row in the worksheet.

Sets the correct headers for Excel file download.

Writes the workbook directly to the HTTP response using a stream.

Ends the response to ensure the file is downloaded properly.

Catches and handles any errors that occur during the export process.

